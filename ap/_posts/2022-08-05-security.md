---
title: セキュリティの用語
category: ap
comment: true
---

## 共通鍵暗号方式
- 暗号化と復号のルールとキーが同一
- 送信者と受信者は同じキーを持つ
- 通信相手が増えるごとに管理するキーの数が増え、鍵管理の負担が大きくなる
- 共通鍵の配布方法が手間になる

### DES
最も代表的な実装方式が`DES`  
2<sup>56</sup>のパターンがある.  
平文を8バイトのブロックに分割し、キーによる変換処理を16回繰り返す.

### AES
`DES`の後継.

## 公開鍵暗号方式

- 公開鍵で暗号化し、秘密鍵で復号する.  
- 公開鍵は広く一般に公開し、誰でも暗号化できる.
- 秘密鍵は、受信者のみが管理するので、受信者だけが暗号化された文書を復号して読むことができる.
- 受信者は、送信者が増えても、秘密鍵を1つ持っていればよいので、鍵管理の負担が少ない.
- 共通鍵暗号方式に比べて、暗号化、復号の処理に時間がかかる.

### RSA
公開鍵暗号方式の代表的な実装方式.  
公開鍵は非常に大きな数値.  
秘密鍵はその素因数分解を行った数値.  

## ハイブリッド方式
共通鍵の受け渡しに公開鍵暗号方式を用いる.  
`S/MIME`, `PGP`, `SSL/TSL`に用いられている.  

## 無線LANの暗号
### WEP
初期の無線LANセキュリティ規格.

### WPA
暗号化アルゴリズム`RC4`を用いた`TKIP`を採用している.  

### WPA2
暗号化方式に`CCMP`を採用している.  
`CCMP`は`CCMP(AES)`とも呼ばれる.

### パーソナルモード
`PSK認証`と呼ばれる認証方式が使われる.

### エンタープライズモード
大規模環境での使用を想定したモード.
`IEEE 802.1X`規格を利用する.  
ネットワーク内に`RADIUSサーバ`を立てる必要がある.  

### IEEE 802.1X
`サプリカント`: 認証を要求するクライアント  
`オーセンティケータ`：認証要求を受け付ける機器  
`認証サーバ`: RADIUSサーバ  

## 認証
### 辞書攻撃
辞書にある単語を片っ端から入力して、パスワードを割り出す方法.  
対策: 辞書にある単語は使わず、ランダムな文字列でパスワードを設定する.  

### ブルートフォース攻撃
総当たり攻撃とも呼ばれる.  
文字を組み合わせてあらゆるパスワードでログインを何度も試みる手法.  
対策: ログインの試行回数に制限を設ける.  

### チャレンジレスポンス認証
1. クライアントがユーザIDを送信する.
2. サーバはチャレンジコード(使い捨ての乱数)をクライアントに送信する.
3. クライアントはチャレンジコードとパスワードを元に生成したハッシュ値をサーバーに返信する
4. サーバは、自分が計算したハッシュ値と、クライアントから送られたハッシュ値を比較し、ユーザー認証を行う.

パスワード自体がネットワーク上を流れないようにしている.

### ハッシュ関数
あるデータを元に行って固定長の擬似乱数を生成する計算手順.  
生成した値をハッシュ値、もしくはメッセージダイジェストという.  
生成したハッシュ値から元のデータを復元できないという性質(原像計算困難性)があることから不可逆関数, 一方向関数とも呼ばれる.

### ワンタイムパスワード
- 時刻同期方式
- S/KEY方式

### シングルサインオン
#### Cookie型
サーバが認証のための情報を生成してクライアントに送信する.   
クライアントはこれを保存し、他のサーバへはこの認証情報を自動的に送ることで、認証を受けることが出来る仕組み.

#### リバースプロキシ型
ユーザはリバースプロキシサーバにアクセスし、認証を受ける.   
ユーザは、このリバースプロキシサーバを通じて他のサーバに接続するため、各サーバの認証はリバースプロキシサーバが自動的に代行する.

#### SAML型
アプリケーション連携を行うためのXML仕様.  
利用するサービスがSAMLに対応していれば、HTTPなどを用いて複数のサービス間で認証情報が自動的にやりとりされる.

### バイオメトリクス認証
#### 指紋認証
::要確認::
#### 声紋認証
::要確認::
#### 虹彩認証
::要確認::
### その他の認証
#### リスクベース認証
::要確認::
#### Kerberos方式
::要確認::
#### 2要素認証
::要確認::
#### CAPTCHA認証
::要確認::


### リモートアクセス
#### PPPの認証技術
`PPP`: Point to Point Protocol. 電話回線で２点間の通信を行うためのデータリンク層のプロトコル.  
`NCP`: 上位プロトコル(IP, IPXなど)に対応した接続モジュールを使ってネットワーク層プロトコルの設定をネゴシエーションする.  
`LCP`: 認証や暗号化の有無などを相手ノードとネゴシエーションする.  

利用される認証プロトコル  
`PAP`:
`CHAP`: 

### RADIUS認証
Remote Authentication Dial-in User Service.  
アクセスサーバーと認証サーバーを分離することで脆弱性を緩和する.  

#### IEEE 802.1X
イーサネットや無線LANにおけるユーザ認証のための規格.  
認証の仕組みとして`RADIUS`を採用している.
認証プロトコルには`PPP`を拡張した`EAP(Extended authentication protocol)`が使われている.  
<br>
以下の3つの構成要素を持つ.  
  `サプリカント`: 認証要求するクライアント  
  `オーセンティケータ`: 認証要求を受け付ける機器. スイッチやアクセスポイント.  
  `認証サーバ`  

## デジタル署名とPKI
### デジタル署名の基本的な仕組み
平文に対して秘密鍵を適用してデジタル署名を作り、平文と共に受信者に送付する.  
受信者は、公開されている送信者の公開鍵を用いてデジタル署名を復号する.  
公開鍵に対応する秘密鍵を持っているのは、公開鍵を公開した送信者だけなので、公開鍵でデジタル署名を復号できれば、送信者が本人であることを確認できる.  

また、送られてきた平文と復号された平文を突き合わせることで、改ざんの有無を検査することもできる.  

### メッセージダイジェスト
可変長の平文に対してハッシュ演算を行い、得られた固定長の`メッセージダイジェスト`からデジタル署名を作成する.  
復号しても得られるのは平文の要約だけのため、セキュリティが向上する.  

`MD5`: 任意の長さの平文から128ビットのハッシュ値を生成  
`SHA-1`: 任意の長さの平文から160ビットのハッシュ値を生成. MD5よりも復元が難しい. SHAは"Secure Hash Algorithm"の略  
`SHA-2`: `SHA-1`の後継規格. ハッシュ値の長さにより、`SHA-224`, `SHA-256` `SHA-384`, `SHA-512`がある. これらをまとめて`SHA-2`と表現する.  
`SHA-3`: アルゴリズムを抜本的に変更することを目論んだ規格. 

### PKI(公開鍵基盤)
公開鍵が本人と結び付けられた正当なものであることを証明するための仕組み.  
#### 認証局(CA)

![認証局の仕組み](ca.jpeg)

`CP`: 証明書の目的や利用用途を定めたもの.  
`CPS`: CAの認証業務の運用などに関する詳細を定めたもの.  

#### デジタル証明書の失効情報
`CRL`: 有効期限内に何らかの理由で失効させられたデジタル証明書のリスト.  

### SSL/TLS
Secure Sockets Layer/Transport Layer Security.  
通信の暗号化、改ざんの検出、サーバの認証を行うセキュアプロトコル.  
アプリケーション層の下位に位置する.  

#### TLSでの通信
##### ハンドシェイクでの通信
サーバを認証して、暗号化鍵を作るためのステップ.  
ここでTSLの通信路を構築し、その通信路を使って暗号化通信を行う.  

##### データの転送(暗号化通信)
送信データに`MAC`と呼ばれる認証符号を付加し、送信データと`MAC`を暗号化して送信する.  
`MAC(メッセージ認証符号)`: 計算元のデータが異なるとMACも異なるという性質を持つため、データの改ざんを検出できる.  

#### サーバ認証とクライアント認証

| 証明書 | description |
|-------|-------------|
| DV証明書|
| OV証明書| 
| EV証明書|

**skip**

## 情報セキュリティ対策

### コンピュータウイルス

| ウイルス  | 機能 |
|----------|-----|
|自己伝染機能| 自身やシステムの機能を使って、他のシステムに自分のコピーを作成する. |
|潜伏機能|ウイルスとしての機能を起動するまでに一定の期間や条件を定めて、それまでは沈黙している. |
|発病機能|メッセージの表示や、ファイルの破損、個人情報の流出などを行う. |

#### 感染経路
ウイルス感染を容易にする要素 

|要素|詳細|
|------|-----|
|セキュリティホール| セキュリティ上の弱点. 主にOSなどのソフトウェアに存在する設計・開発時における瑕疵を指す|
|バックドア| ウイルスなどが作成するシステム上の抜け道|
|マクロ| ワープロや表計算でのプログラミング機能. マクロウイルスと正当なマクロを区別するのは難しい|

#### 対策
##### ウイルスチェックソフト
パターンファイル(シグネチャ)と呼ばれるウイルスの特徴を記載したデータベースを保持して、メールやホームページの閲覧データを常時チェックする.  
パターンファイルは過去のウイルス情報の蓄積なので、最新のウイルスには対応できないことや、常に新しいパターンファイル情報を取得が必要不可欠.  

##### セキュリティパッチ
OSなどにセキュリティホールがあった場合、開発元からそれを修正するためのプログラムが配布される. これをセキュリティパッチという.  

##### ビヘイビア法
検査対象プログラムを仮想環境内で実行して、その挙動を監視し、ウイルスによく見られる行動を起こせばウイルスとして検知する.  
ポリモーフィック型ウイルスなどにも対応できる.  

### ネットワークセキュリティ
#### ファイアウォール
リモートネットワークと社内LANなどのローカルネットワークの境界線に設置し、不正なデータの通貨を阻止する.  

|方式|フィルタリングの要素|
|----|----------------|
|パケットフィルタリング型| パケットのIPアドレス、ポート番号をチェックして、フィルタリングを行う|
|サーキットレベルゲートウェイ型|セグメントレベルのフィルタリングを行い、データを中継する|
|アプリケーションゲートウェイ型|アプリケーションプロトコルレベルのフィルタリングを行い、データを中継する|


##### ルールベース
パケットの通貨の可否を判断するための、フィルタリングルールの集合.  

#### プロキシサーバ
クライアントからインターネット上のWebサーバへのアクセス要求を中継するもの.  

#### リバースプロキシサーバ
インターネットからのアクセスをWebサーバに中継するのも.  

#### WAF
Web Application Firewall.  
Webアプリケーションのやりとりを監視し、アプリケーションレベルの不正なアクセスを阻止するファイヤウォール.  
SQLインジェクションなどの攻撃を遮断する.  

|方式|詳細|
|----|---|
|ホワイトリスト方式|原則として通信を遮断し、ホワイトリストと一致した通信のみを通過させる|
|ブラックリスト方式|原則として通信を許可し、ブラックリストと一致した通信は遮断するか、あるいは無害化する|

#### TLSアクセラレータ
HTTPSでの通信の場合、TLSの処理がWebサーバの大きな負担になる.  


#### セキュリティ対策機器

|対策機器|詳細|
|------|----|
|NIDS|ネットワーク型IDS. 管理下のネットワークを監視し、不正なパケットが通過した場合、または通信量が通常とは異なる異常値を示した場合にそれを検知して通知する|
|HIDS|ホスト型IDS. ホストにインストールして、そのホストのみを監視する. パケットの分析だけでなく、シグネチャとのパターンマッチングを失敗させるためのパケットが挿入された攻撃でも検知できる|
|IPS|侵入防止システム. 不正パケットの検出だけでなく、それを検出した際には通信を遮断するなどの対処も行う|
|ハニーボット|ダミーとして使われるサーバやネットワーク機器の総称. 攻撃のログを取ることで、攻撃元の特定や対策に利用する|


#### 不正検知方法
##### シグネチャ方式
シグネチャと呼ばれるデータベースかされた既知の攻撃パターンと通信パケットとのパターンマッチングによって、不正なパケットを検出する.  
##### アノマリ方式
正常なパターンを定義し、それに反するものを全て異常だとみなす方式. 未知の攻撃にも有効に機能し、新種の攻撃も検出できる.  

##### フォールスポジティブ
誤検知

##### フォールスネガティブ
検知漏れ


#### VPN
Virtual Private Network.  
認証技術や暗号化技術を利用して、アクセスが許可されたユーザ以外は通信内容にアクセスできないようにしている.  

|モード|詳細|
|----|----|
|トランスポートモード|通信を行う端末が直接データの暗号化を行う. ペイロードのみの暗号化であり、IPアドレスは暗号化されないため、宛先の盗聴が可能になる|
|トンネルモード|送信側ゲートウェイでは、IPsecを利用しIPパケットを暗号化してから受信側のデートウェイ宛のIPヘッダを新たにつける. 受信側ではゲートウェイでIPパケットを復号し、真の宛先に送信する|

##### IPsec
IPレベルで暗号化や認証、改ざんの検知を行う.  
認証だけを行う場合は認証ヘッダ, 認証と暗号化を行う場合は、暗号ペイロードを用いる.  
通信を開始する前に、暗号化方式の決定と鍵交換を行う. このフェーズをIKE(Internet Key Exchange)という.  


## 情報セキュリティの脅威と攻撃手法

### 不正アクセス

|手法|詳細|
|----|---|
|ポートスキャン|攻撃を行うコンピュータの全てのポートにパケットを送信し、応答の有無を確認するこどで、そのコンピュータがどのようなサービスを動かしているか推測する. 攻撃の事前調査として使われる|
|セキュリティホール攻撃|バッファオーバフロー攻撃が多い|

### 攻撃手法

|攻撃手法|詳細|
|-------|---|
|IPスプーフィング|IPアドレスを偽造して正規のユーザのふりをする|
|ARPスプーフィング|ARPの問い合わせに対して、正規のノードよりも先に偽のMACアドレスを返すことにより、IPアドレスに対するMACアドレスの不正な対応関係を作り出す|
|バッファオーバーフロー攻撃|バッファの許容範囲を超えるデータを送り付けて、意図的にバッファをオーバーフローさせる. 許容範囲を超えた大きなデータの書き込みを禁止するなどの対策が必要. |
|ディレクトリトラバーサル攻撃|相対パスなどを使って、後悔していないディレクトリにアクセスする. ユーザに入力させるパラメタのチェックなどにより対策する|
|SQLインジェクション|サニタイジング: 'や:を無効にする. バインド機構: 入力値をプレースホルダに埋め込み、SQL文を組み立てる|
|OSコマンドインジェクション|不正にシェルスクリプトを実行させる|
|フィッシング|オープンリダイレクトを悪用して個人情報を盗み取る|
|スミッシング|実在企業を装ったメールで偽サイトへ誘導し、個人情報を盗み取る|
|DNSキャッシュポイズニング|DNSキャッシュを悪用し、偽のドメイン情報を一時的に覚え込ませる攻撃.  対策は、`DNSSEC`の導入や、DNSヘッダ内のIDやソースポートのランダム化.|
|クロスサイトスクリプティング|閲覧者のWebブラウザ上でスクリプトを実行させる|
|SEOポイズニング|検索結果上位に悪意のあるサイトを意図的に表示させ、誘導する. |
|DoS攻撃| 正規のサービス要求を大量に繰り返すことでサーバーを過負荷状態にする|
|DNS amp攻撃|分散型サービス妨害. DNS問い合わせパケットをDNSキャッシュサーバーに送り、DNS応答パケットを攻撃対象に送らせる|
|NTP増幅攻撃|NTPサーバを踏み台とした攻撃. `monlist`要求をNTPサーバに送り、NTPサーバから非常に大きなサイズの応答を攻撃対象に送らせる|
|スマーフ攻撃|大量のICMPエコー応答パケットを送りつける|
|ICMP flood攻撃|ボットなどを利用して、ICMPエコー要求パケットを大量に送りつける|
|SYN Flood攻撃|SYNパケットを送信元を偽装して大量に送りつける|
|標的型攻撃|特定の組織や個人に対して行われる攻撃. 執拗に継続的に行われる攻撃を`APT`という|
|水飲み場攻撃|標的が頻繁に利用するWebサイトに罠を仕掛けて、アクセスした時だけ攻撃コードを実行させる攻撃|
|SSL/TLSのダウングレード攻撃|脆弱性が見つかっている弱い暗号スイートの使用を強制させる|
|中間者攻撃|通信者同士の間に勝手に割り込み、盗み見たり改竄した後、改めて正しい通信相手に転送するバケツリレー型攻撃|
|リプレイ攻撃|盗聴によりえた認証情報を、そのまま再利用して不正にログインする|
|MITB攻撃|マルウェアを利用して、Webブラウザからの通信を監視し、通信内容を改竄したり、セッションを乗っ取る|
|ドライブバイダウンロード攻撃|利用者が気づかないうちに不正プログラムを転送させる|
|スパムメール|無断で送り付けられてくる広告メールや意味のないメール. 対策: `OP25B`, `SPF`, `送信ドメイン認証`|
|ソーシャルエンジニアリング|非電子的な方法によって機密情報を不正に入手することの総称|
|パスワードリスト攻撃|流出したID, Passを用いて、他のWebサイトに対してログインを試行する|
|レインボー攻撃|パスワードとなりうる文字列のハッシュ値を事前に計算し、`レインボーテーブル`として管理して使用する|
|サイドチャネル攻撃|暗号装置から得られる物理量やエラーメッセージから、機密情報を取得する|
|RLTrap|Unicodeの制御文字`RLO`を悪用してファイル名を偽装する|
|エクスプロイトコード|新しく発見されたセキュリティ上の脆弱性を検証するための実証用コード|


## 情報セキュリティ管理
### リスク分析

1. 分析対象の理解と分析計画
2. 脆弱性の発見と識別
3. 事故様態の関連分析と損失額予想
4. 損失の分類と影響度の評価
5. 対策の検討、評価と優先順位の決定


### リスク対応
#### リスクコントロール
リスク回避  
リスク最適化  
リスク移転  
リスク保有  


#### リスクファイナンス
リスク移転  
リスク保有


## セキュリティ評価
### ISO/IEC 15408
情報システムを構成する機器がどれだけのセキュリティを実装しているかを示すための国際基準.  

### ISO/IEC 27001
組織のセキュリティ運用体制を規定する.  

### 情報セキュリティ組織・機関

|組織名|説明|
|-----|----|
|CSIRT|インシデントが発生した時、その報告を受け、調査し、対応活動を行う組織・体制の総称|
|JPCERT/CC|日本の代表的なCSIRT|
|J-CRAT|IPAが組織した、標的型サイバー攻撃対策組織|
|CRYPTREC|暗号技術の実装法、運用法を調査検討するプロジェクト|
|CVSS|共通脆弱性評価システム|


